<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Piece TCG 2v2 Tournament Manager</title>
    <link rel="stylesheet" href="tournament_styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öîÔ∏è One Piece TCG 2v2 Tournament Manager</h1>
            <div id="save-status" style="font-size: 0.8em; margin-top: 5px; opacity: 0.7;"></div>
        </div>

        <!-- Tournament Setup -->
        <div id="setup-section" class="section">
            <div class="card">
                <h2 class="section-title">Tournament Setup</h2>
                <div class="form-group">
                    <label for="tournament-name">Tournament Name:</label>
                    <input type="text" id="tournament-name" placeholder="Enter tournament name">
                </div>
                <div class="form-group">
                    <label for="tournament-format">Tournament Format:</label>
                    <select id="tournament-format">
                        <option value="swiss">Swiss System</option>
                        <option value="round-robin">Round Robin</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="bye-points">BYE Points (only for odd number of teams):</label>
                    <select id="bye-points">
                        <option value="0">0 points</option>
                        <option value="1">1 point</option>
                        <option value="2">2 points</option>
                        <option value="3" selected>3 points (default)</option>
                        <option value="4">4 points</option>
                        <option value="5">5 points</option>
                    </select>
                    <small style="color: #666; font-size: 0.85em;">Note: BYE only occurs with odd number of teams, maximum one per round</small>
                </div>
                <div class="form-group">
                    <label for="custom-rounds">Custom Round Count (optional - for reference only):</label>
                    <input type="number" id="custom-rounds" min="1" max="20" placeholder="Leave empty for official rules">
                    <small style="color: #666; font-size: 0.9em; display: block; margin-top: 5px;">
                        Note: Tournament will not auto-complete. Players decide when to finish by clicking "Complete Tournament"
                    </small>
                </div>
                <button onclick="initializeTournament()">Initialize Tournament</button>
                <div style="margin-top: 15px;">
                    <button onclick="clearStorage()" class="btn-danger">üóëÔ∏è Clear Storage</button>
                </div>
                <div style="margin-top: 10px;">
                    <button onclick="resetMatches()" class="btn-danger" id="reset-matches-btn" disabled>üîÑ Reset Matches (Keep Teams)</button>
                </div>
            </div>


        </div>

        <!-- Teams -->
        <div id="teams-section" class="section">
            <div class="card">
                <h2 class="section-title">Team Registration</h2>
                <div class="form-group">
                    <label for="team-name-2">Team Name:</label>
                    <input type="text" id="team-name-2" placeholder="Enter team name">
                </div>
                <div class="form-group">
                    <label for="player1-name-2">Player 1 Name:</label>
                    <input type="text" id="player1-name-2" placeholder="Enter Player 1 name">
                </div>
                <div class="form-group">
                    <label for="player2-name-2">Player 2 Name:</label>
                    <input type="text" id="player2-name-2" placeholder="Enter Player 2 name">
                </div>
                <div class="form-group" style="background: #f0f8ff; padding: 15px; border-radius: 5px; border: 2px solid #2c5aa0; margin: 10px 0;">
                    <button type="button" id="solo-toggle-btn" onclick="toggleSoloMode()" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; width: 100%;">
                        üéØ Normal Team Mode (Click to switch to Solo)
                    </button>
                    <input type="hidden" id="solo-team-checkbox" value="false">
                </div>
                <div class="form-group" style="background: #e7f3ff; padding: 15px; border-radius: 5px; border: 2px solid #007bff; margin: 10px 0;">
                    <label style="margin-bottom: 10px; color: #004085; font-weight: bold;">
                        üèÜ Official Priority Rules:
                    </label>
                    <div style="color: #004085; font-size: 0.9em; line-height: 1.4;">
                        <strong>Round 1:</strong> All Player 1s have priority table<br>
                        <strong>Round 2:</strong> All Player 2s have priority table<br>
                        <strong>Round 3:</strong> All Player 1s have priority table<br>
                        <em>Pattern continues automatically...</em>
                    </div>
                </div>
                <button onclick="registerTeamFromTeamsTab()">Register Team</button>
            </div>
            
            <div class="card">
                <h2 class="section-title">Registered Teams</h2>
                <div id="teams-list" class="team-list">
                    <!-- Teams will be displayed here -->
                </div>
                <button onclick="startTournament()" id="start-tournament-btn" class="btn-success" disabled>Start Tournament</button>
            </div>
        </div>

        <!-- Matches -->
        <div id="matches-section" class="section">
            <div class="card">
                <div class="tournament-status" id="tournament-status">
                    Tournament not started
                </div>
                <h2 class="section-title">Current Round Matches</h2>
                <div id="current-matches">
                    <!-- Current round matches will be displayed here -->
                </div>
                <div style="display: flex; gap: 20px; justify-content: center; margin-top: 15px;">
                    <button onclick="generateNextRound()" id="next-round-btn" class="btn-success hidden">Generate Next Round</button>
                    <button onclick="completeTournament()" id="complete-tournament-btn" class="btn-warning" disabled title="Complete all matches in current round first">üèÜ Complete Tournament</button>
                </div>
            </div>
        </div>

        <!-- Standings -->
        <div id="standings-section" class="section">
            <div class="card">
                <h2 class="section-title">Tournament Standings</h2>
                <table class="standings-table" id="standings-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Team</th>
                            <th>Match Points</th>
                            <th>OMW%</th>
                            <th>OOMW%</th>
                            <th>Matches Played</th>
                        </tr>
                    </thead>
                    <tbody id="standings-body">
                        <!-- Standings will be displayed here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Match History -->
        <div id="match-history-section" class="section">
            <div class="card">
                <h2 class="section-title">Match History</h2>
                <table class="standings-table" id="match-history-table">
                    <thead>
                        <tr>
                            <th>Round</th>
                            <th>Team 1</th>
                            <th>Team 2</th>
                            <th>Game 1 Result</th>
                            <th>Game 2 Result</th>
                            <th>Points</th>
                            <th>Match Winner</th>
                        </tr>
                    </thead>
                    <tbody id="match-history-body">
                        <!-- Match history will be displayed here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="tournament_script.js" type="module"></script>
</body>
</html>